<!doctype html>
<html lang="fr">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>MerdiVersa — Générateur d'images</title>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;700&display=swap" rel="stylesheet">
<style>
:root{
  --bg:#0c0f1f;
  --card:rgba(255,255,255,0.05);
  --accent1:#6b8eff;
  --accent2:#ff6b6b;
  --text:#eaf0ff;
  --muted:rgba(255,255,255,0.65);
}
*{box-sizing:border-box;margin:0;padding:0;font-family:'Inter',sans-serif;}
body{background:var(--bg);color:var(--text);display:flex;flex-direction:column;min-height:100vh;padding:24px;}
header{display:flex;justify-content:space-between;align-items:center;padding:16px 24px;background:#111;border-radius:12px;margin-bottom:24px;}
header h1{margin:0;font-size:22px;background:linear-gradient(90deg,var(--accent1),var(--accent2));-webkit-background-clip:text;-webkit-text-fill-color:transparent;}
header nav{display:flex;gap:12px;}
header .btn{padding:8px 14px;border-radius:10px;border:1px solid rgba(255,255,255,0.1);background:transparent;color:var(--muted);font-weight:600;cursor:pointer;}
header .btn.primary{background:linear-gradient(90deg,var(--accent1),var(--accent2));border:none;color:white;}

.main{flex:1;display:flex;flex-direction:column;align-items:center;gap:16px;}
.input-area{display:flex;width:100%;max-width:600px;gap:8px;}
.input-area input{flex:1;padding:12px 16px;border-radius:12px;border:1px solid #333;background:#111;color:var(--text);outline:none;}
.input-area button{padding:0 20px;border-radius:12px;border:none;background:linear-gradient(90deg,var(--accent1),var(--accent2));color:white;font-weight:600;cursor:pointer;}

.image-container{position:relative;width:100%;max-width:600px;height:400px;border:2px solid rgba(255,255,255,0.1);border-radius:16px;display:grid;place-items:center;background:var(--card);overflow:hidden;}
.image-container img{max-width:100%;max-height:100%;border-radius:16px;object-fit:contain;}
.loader{border:4px solid rgba(255,255,255,0.2);border-top:4px solid var(--accent1);border-radius:50%;width:36px;height:36px;animation:spin 1s linear infinite;}
@keyframes spin{0%{transform:rotate(0deg);}100%{transform:rotate(360deg);}}

.download-btn{margin-top:8px;padding:10px 18px;border:none;border-radius:12px;background:linear-gradient(90deg,var(--accent1),var(--accent2));color:white;font-weight:600;cursor:pointer;}
footer{text-align:center;padding:12px;color:var(--muted);font-size:13px;margin-top:24px;}
</style>
</head>
<body>

<header>
  <h1>MerdiVersa</h1>
  <nav>
    <button class="btn" onclick="location.href='index.html'">Accueil</button>
    <button class="btn" onclick="location.href='chat.html'">Chat IA</button>
    <button class="btn" onclick="location.href='music.html'">Musique</button>
  </nav>
</header>

<div class="main">
  <div class="input-area">
    <input type="text" id="prompt" placeholder="Décrivez l'image à générer...">
    <button id="generate">Générer</button>
  </div>

  <div class="image-container" id="imageBox">
    <!-- Image et loader apparaîtront ici -->
  </div>

  <button id="download" class="download-btn" style="display:none;">Télécharger l'image</button>
</div>

<footer>© 2025 MerdiVersa — Créé par Merdi Madimba</footer>

<script>
const promptInput = document.getElementById('prompt');
const generateBtn = document.getElementById('generate');
const imageBox = document.getElementById('imageBox');
const downloadBtn = document.getElementById('download');
let currentImageURL = '';

generateBtn.addEventListener('click', async () => {
  const userPrompt = promptInput.value.trim();
  if(!userPrompt) return;

  // Supprimer image précédente
  imageBox.innerHTML = '';
  downloadBtn.style.display = 'none';

  // Afficher loader
  const loader = document.createElement('div');
  loader.className = 'loader';
  imageBox.appendChild(loader);

  try {
    // Créer prompt final incluant "MerdiVersa" pour watermark dans l'image
    const finalPrompt = `Génère une image correspondant à : ${userPrompt}. Intègre de façon visible le texte "MerdiVersa" dans l'image en bas à droite en petit.`;

    // Envoyer à Anychuan Gemini pour traitement
    const apiUrl = `https://shizuapi.onrender.com/api/fluxpro?prompt=${encodeURIComponent(finalPrompt)}`;
    const res = await fetch(apiUrl);
    const blob = await res.blob();
    const imageUrl = URL.createObjectURL(blob);
    currentImageURL = imageUrl;

    // Supprimer loader et afficher l'image
    loader.remove();
    const img = document.createElement('img');
    img.src = imageUrl;
    imageBox.appendChild(img);

    // Afficher bouton téléchargement
    downloadBtn.style.display = 'block';

  } catch(err) {
    console.error(err);
    loader.remove();
    imageBox.innerHTML = '<p style="color:red;text-align:center;">Erreur lors de la génération.</p>';
  }
});

// Télécharger l'image
downloadBtn.addEventListener('click', () => {
  if(!currentImageURL) return;
  const a = document.createElement('a');
  a.href = currentImageURL;
  a.download = 'MerdiVersa_Image.png';
  document.body.appendChild(a);
  a.click();
  a.remove();
});
</script>

</body>
</html>
